<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); }
        .loader { font-size: 20px; font-weight: bold; }
        .instruction { margin-top: 20px; font-size: 16px; color: #3390ec; }
    </style>
</head>
<body>
    <div class="loader" id="status">ğŸ” Obteniendo tu IP...</div>
    <div class="instruction" id="hint" style="display:none;">
        âœ… Â¡Hecho!<br><br>
        1. Se abrirÃ¡ el chat.<br>
        2. Pulsa el botÃ³n <b>ENVIAR</b> (âœˆï¸).
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();

        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                const userIp = data.ip;
                
                // Mostramos instrucciones visuales
                document.getElementById('status').innerText = "âœ… IP: " + userIp;
                document.getElementById('hint').style.display = 'block';
                
                setTimeout(function() {
                    // âš ï¸ IMPORTANTE: REVISA QUE ESTE SEA TU BOT âš ï¸
                    const botName = "aaz_adviser_bot"; 
                    
                    // 1. Abrimos el enlace (Escribe el mensaje pero NO lo envÃ­a)
                    tg.openTelegramLink("https://t.me/" + botName + "?start=" + userIp);
                    
                    // 2. FORZAMOS EL CIERRE DE LA VENTANA
                    tg.close();
                    
                }, 1000);
            })
            .catch(error => {
                document.getElementById('status').innerText = "âŒ Error detectando IP";
            });
    </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: var(--tg-theme-bg-color, #212121); 
            color: var(--tg-theme-text-color, white);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; margin: 0;
        }
        .card {
            background: var(--tg-theme-secondary-bg-color, #2c2c2c);
            padding: 20px; border-radius: 12px; width: 80%; text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        h2 { margin: 0 0 10px 0; font-size: 18px; }
        .ip { font-size: 24px; font-weight: bold; color: #4caf50; margin: 15px 0; letter-spacing: 1px; }
        
        button {
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, white);
            border: none; padding: 14px 24px; border-radius: 8px;
            font-size: 16px; font-weight: bold; cursor: pointer; width: 100%;
            transition: opacity 0.2s;
        }
        button:active { opacity: 0.8; }
        button:disabled { background-color: #555; cursor: wait; }
    </style>
</head>
<body>

    <div class="card">
        <h2 id="title">üîç Detectando...</h2>
        <div class="ip" id="ip-display">...</div>
        <button id="btn" onclick="sendIp()" disabled>Espere...</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // ‚ö†Ô∏è‚ö†Ô∏è PON AQU√ç EL NOMBRE DE TU BOT (SIN @) ‚ö†Ô∏è‚ö†Ô∏è
        const BOT_USERNAME = "aaz_adviser_bot"; 
        
        let foundIp = "";

        // 1. Buscamos la IP al cargar
        fetch('https://api.ipify.org?format=json')
            .then(res => res.json())
            .then(data => {
                foundIp = data.ip;
                document.getElementById('title').innerText = "‚úÖ IP Detectada";
                document.getElementById('ip-display').innerText = foundIp;
                
                // Activamos el bot√≥n
                const btn = document.getElementById('btn');
                btn.innerText = "ENVIAR AL BOT üöÄ";
                btn.disabled = false;
            })
            .catch(err => {
                document.getElementById('title').innerText = "‚ùå Error";
                document.getElementById('ip-display').innerText = "Sin conexi√≥n";
            });

        // 2. Funci√≥n que se ejecuta SOLO al hacer clic
        function sendIp() {
            if(!foundIp) return;
            
            // Construimos el enlace
            const link = "https://t.me/" + BOT_USERNAME + "?start=" + foundIp;
            
            // ABRIMOS EL ENLACE
            tg.openTelegramLink(link);
            
            // Cerramos la ventana medio segundo despu√©s para dar tiempo a que cargue
            setTimeout(() => {
                tg.close();
            }, 500);
        }
    </script>
</body>
</html>


                const botName = "aaz_adviser_bot"; 
